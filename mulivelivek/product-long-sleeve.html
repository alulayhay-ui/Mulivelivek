<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>初鹿部落年祭限定水洗長袖｜Mulivelivek</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root { --bg: #f7f3ec; --bg-soft: #fffdf8; --card: #ffffff; --border: #e3ddcf; --accent: #c58543; --accent-dark: #92572a; --text: #2f2415; --muted: #7b6d5c; --black: #111111; }
    * { box-sizing: border-box; }
    body { margin: 0; min-height: 100vh; font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); }
    a { color: inherit; text-decoration: none; }

    /* Header */
    .site-header { background: #ffffffee; backdrop-filter: blur(6px); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 10; }
    .header-inner { max-width: 1080px; margin: 0 auto; padding: 10px 16px; display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .brand { display: flex; align-items: center; gap: 10px; }
    .brand-mark { width: 32px; height: 32px; border-radius: 50%; border: 1px solid var(--border); background: radial-gradient(circle at 30% 20%, #f5d7a1, #c58b4a); }
    .brand-text-main { font-size: 1.05rem; font-weight: 600; }
    
    .header-nav { display: flex; align-items: center; gap: 16px; font-size: 0.85rem; color: var(--muted); }
    .header-nav a:hover { color: var(--accent); }
    .header-cart-pill { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border); background: var(--bg-soft); font-size: 0.8rem; cursor: pointer; }
    .header-cart-count { min-width: 18px; height: 18px; border-radius: 999px; background: var(--accent); color: #fff; display: inline-flex; align-items: center; justify-content: center; font-size: 0.7rem; }

    /* Product Page */
    .page { max-width: 1100px; margin: 0 auto; padding: 24px 16px 40px; }
    .breadcrumb { font-size: 0.8rem; color: var(--muted); margin-bottom: 12px; }
    .product-shell { background: #fdfaf4; border-radius: 26px; padding: 24px; display: grid; grid-template-columns: 1.3fr 1.1fr; gap: 30px; border: 1px solid var(--border); }
    @media (max-width: 800px) { .product-shell { grid-template-columns: 1fr; } }
    
    .image-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .image-box { background: #e5ded1; border-radius: 14px; position: relative; padding-top: 90%; }
    
    .info-panel { background: #ffffff; border-radius: 18px; border: 1px solid var(--border); padding: 18px; display: flex; flex-direction: column; gap: 10px; }
    .title-main { font-size: 1.4rem; font-weight: 700; margin: 0; }
    .price { font-size: 1.1rem; font-weight: 600; margin-top: 8px; }
    
    .size-row { display: flex; gap: 8px; margin-top: 4px; flex-wrap: wrap; }
    .size-btn { padding: 8px 14px; border: 1px solid var(--border); border-radius: 8px; background: #fff; cursor: pointer; }
    .size-btn.active { background: #000; color: #fff; border-color: #000; }
    
    .qty-row { display: inline-flex; border: 1px solid var(--border); border-radius: 999px; margin-top: 4px; }
    .qty-btn { width: 32px; height: 32px; background: transparent; border: none; cursor: pointer; }
    .qty-display { width: 40px; height: 32px; display: flex; align-items: center; justify-content: center; border-left: 1px solid var(--border); border-right: 1px solid var(--border); }

    .btn-black { background: #000; color: #fff; width: 100%; padding: 12px; border-radius: 99px; font-weight: 600; border: none; cursor: pointer; margin-top: 10px; }
    .btn-black:hover { background: #333; }

    /* Mini Cart */
    .mini-cart-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.2); display: none; justify-content: flex-end; padding: 20px; z-index: 50; }
    .mini-cart-panel { width: 300px; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .mini-cart-btn { display: block; width: 100%; text-align: center; padding: 10px; border-radius: 99px; margin-top: 8px; text-decoration: none; font-size: 0.9rem; font-weight: 600; }
    .btn-checkout { background: var(--accent); color: #fff; }
    .btn-view { border: 1px solid var(--border); color: var(--text); }

    /* ✨ AI Styling Section */
    .ai-styling-section {
      margin-top: 30px;
      padding: 24px;
      background: linear-gradient(135deg, #fffdf8 0%, #f7f3ec 100%);
      border: 1px dashed var(--accent);
      border-radius: 18px;
    }
    .ai-styling-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent-dark);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .ai-styling-input-group {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    .ai-style-input {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 0.9rem;
    }
    .ai-style-btn {
      padding: 10px 16px;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .ai-style-btn:hover { background: var(--accent-dark); }
    .ai-style-result {
      margin-top: 16px;
      font-size: 0.9rem;
      color: var(--text);
      line-height: 1.6;
      background: #fff;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      display: none; /* 預設隱藏 */
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="brand"><div class="brand-mark"></div><div class="brand-text-main">Mulivelivek</div></div>
      <nav class="header-nav">
        <a href="index.html">首頁</a>
        <a href="products.html">所有商品</a>
        <a href="gallery.html">部落相簿</a>
        <a href="order-tracking.html">訂單查詢</a>
      </nav>
      <a href="cart.html" class="header-cart-pill">購物車 <span id="headerCartCount">0</span></a>
    </div>
  </header>

  <main class="page">
    <div class="breadcrumb"><a href="index.html">首頁</a> / <a href="products.html">所有商品</a> / <span>水洗長袖</span></div>
    
    <section class="product-shell">
      <div class="image-grid">
        <div class="image-box"></div><div class="image-box"></div>
      </div>
      <div class="info-panel">
        <h1 class="title-main">初鹿部落年祭限定水洗長袖</h1>
        <div class="price">NT$ 450</div>
        
        <div>
          <div style="font-size:0.85rem; color:var(--muted); margin-top:10px;">尺寸</div>
          <div class="size-row">
            <button class="size-btn active" onclick="setSize(this, 'M')">M</button>
            <button class="size-btn" onclick="setSize(this, 'L')">L</button>
            <button class="size-btn" onclick="setSize(this, 'XL')">XL</button>
            <button class="size-btn" onclick="setSize(this, '2XL')">2XL</button>
          </div>
        </div>

        <div>
          <div style="font-size:0.85rem; color:var(--muted); margin-top:10px;">數量</div>
          <div class="qty-row">
            <button class="qty-btn" onclick="updateQty(-1)">-</button>
            <div class="qty-display" id="qtyDisplay">1</div>
            <button class="qty-btn" onclick="updateQty(1)">+</button>
          </div>
        </div>

        <button class="btn-black" id="addToCartBtn">加入購物車</button>
      </div>
    </section>

    <!-- ✨ AI 穿搭建議區塊 -->
    <section class="ai-styling-section">
      <div class="ai-styling-title">✨ AI 穿搭顧問</div>
      <p style="font-size:0.9rem; color:var(--muted); margin:0;">
        不知道這件寬版水洗長袖該怎麼搭嗎？告訴我你想去的場合，我來幫你出主意！
      </p>
      <div class="ai-styling-input-group">
        <input type="text" class="ai-style-input" id="styleInput" placeholder="例如：今天要跟朋友去露營、或是在咖啡廳看書...">
        <button class="ai-style-btn" id="styleBtn">獲得建議</button>
      </div>
      <div class="ai-style-result" id="styleResult"></div>
    </section>

  </main>

  <!-- Mini Cart -->
  <div class="mini-cart-overlay" id="miniCart">
    <div class="mini-cart-panel">
      <h3 style="margin-top:0;">已加入購物車</h3>
      <p style="font-size:0.9rem; color:var(--muted);">初鹿部落年祭限定水洗長袖 <span id="miniSize"></span></p>
      <a href="cart.html" class="mini-cart-btn btn-checkout">前往結帳</a>
      <a href="cart.html" class="mini-cart-btn btn-view">查看購物車</a>
      <button class="mini-cart-btn" style="background:none; border:none; text-decoration:underline; cursor:pointer;" onclick="closeMiniCart()">繼續購物</button>
    </div>
  </div>

  <script>
    let currentSize = 'M';
    let qty = 1;
    const CART_KEY = 'mulivelivekCart';

    function setSize(btn, size) {
      document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentSize = size;
    }

    function updateQty(n) {
      if(qty + n > 0) { qty += n; document.getElementById('qtyDisplay').textContent = qty; }
    }

    function loadCart() { try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); } catch { return []; } }
    function saveCart(c) { localStorage.setItem(CART_KEY, JSON.stringify(c)); updateHeader(); }
    function updateHeader() { document.getElementById('headerCartCount').textContent = loadCart().reduce((s,i)=>s+(i.quantity||0),0); }

    document.getElementById('addToCartBtn').addEventListener('click', () => {
      const cart = loadCart();
      cart.push({ style: '初鹿部落年祭限定水洗長袖', size: currentSize, quantity: qty, price: 450 });
      saveCart(cart);
      document.getElementById('miniSize').textContent = `(尺寸: ${currentSize})`;
      document.getElementById('miniCart').style.display = 'flex';
    });

    function closeMiniCart() { document.getElementById('miniCart').style.display = 'none'; }
    updateHeader();

    // ✨ Gemini AI Styling Logic
    const styleBtn = document.getElementById('styleBtn');
    const styleInput = document.getElementById('styleInput');
    const styleResult = document.getElementById('styleResult');

    styleBtn.addEventListener('click', async () => {
      const occasion = styleInput.value.trim();
      if(!occasion) return;

      styleBtn.textContent = '思考中...';
      styleBtn.disabled = true;
      styleResult.style.display = 'block';
      styleResult.textContent = '✨ AI 正在為您構思穿搭...';

      try {
        const apiKey = ""; // 系統會自動填入 API Key
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: `我有一件「淺灰色水洗、粉色字體、寬版 Oversized」的部落潮流長袖上衣。我要去「${occasion}」。請給我具體的穿搭建議（包含褲子、鞋子、配件），風格要帥氣且符合部落潮流感。` }] }]
          })
        });

        const data = await response.json();
        const suggestion = data.candidates?.[0]?.content?.parts?.[0]?.text;
        styleResult.textContent = suggestion || "抱歉，AI 暫時無法提供建議，請稍後再試。";

      } catch (e) {
        styleResult.textContent = "發生錯誤，請檢查網路連線。";
      } finally {
        styleBtn.textContent = '獲得建議';
        styleBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
